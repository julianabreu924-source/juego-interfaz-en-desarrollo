
/* --- GENSHIN-INSPIRED 2D GACHA --- */

/* 1. ATMOSPHERIC BACKGROUND (Pixelated) */
.gacha-overlay {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  background-color: #090a0f;
  background-image: 
      linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
  background-size: 20px 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 200;
  overflow: hidden;
  font-family: 'Press Start 2P', cursive;
  image-rendering: pixelated;
}

/* Moving Stars Background as Pixels */
.stars-bg-layer {
  position: absolute;
  width: 200%;
  height: 200%;
  background-image: 
      radial-gradient(square, #fff 1px, transparent 1px), /* Square dots ideally, but radial is fine if small */
      linear-gradient(45deg, transparent 49%, #fff 49%, #fff 51%, transparent 51%); /* Tiny stars */
  background-size: 50px 50px;
  animation: starScroll 60s steps(60) infinite; /* Stepped animation */
  opacity: 0.3;
  z-index: 0;
}
@keyframes starScroll {
  from { transform: translateY(0); }
  to { transform: translateY(-50px); } /* Short loop for pattern */
}

/* 2. BANNER LAYOUT (Pixel Art Style) */
/* 2. BANNER LAYOUT (Pixel Art Style) */
.wish-banner {
  position: relative;
  width: 90%;
  height: 85%;
  max-width: 1100px;
  background: #150920;
  border: 4px solid #b39ddb; /* Lighter purple pixel border */
  display: flex;
  /* overflow: hidden; -- REMOVED to prevent clipping of buttons */
  box-shadow: 
    0 0 0 4px #000, /* Hard outer outline */
    12px 12px 0 #000; /* Hard drop shadow */
  z-index: 10;
  image-rendering: pixelated;
}

/* Texture Overlay */
.wish-banner::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  background-image: 
    linear-gradient(45deg, #000 25%, transparent 25%, transparent 75%, #000 75%, #000), 
    linear-gradient(45deg, #000 25%, transparent 25%, transparent 75%, #000 75%, #000);
  background-position: 0 0, 2px 2px;
  background-size: 4px 4px;
  opacity: 0.1;
  z-index: 0;
}

/* Left: Character Art */
.banner-art-section {
  flex: 2; /* Give priority space to the character */
  position: relative;
  overflow: hidden; 
  background: radial-gradient(circle at center, #2d1640 0%, #150920 100%);
  border-right: 4px solid #b39ddb; /* Match main border */
}
.banner-art-frame {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  position: relative;
}
.banner-char-img {
  height: 95%; 
  position: absolute;
  bottom: 0;
  left: 10%; /* Shift even further left */
  transform: translateX(-50%);
  filter: drop-shadow(8px 8px 0 #000);
  z-index: 2;
  max-width: none; /* specific override just in case */
}

/* Right: Info & Controls */
.banner-info-section {
  flex: 1.1; /* Reduce width of text section */
  padding: 20px; /* Tighter padding */
  display: flex;
  flex-direction: column;
  justify-content: center; 
  align-items: center; 
  position: relative;
  background: #11061a;
  box-shadow: inset 8px 0 0 rgba(0,0,0,0.3); /* Inner shadow for depth */
  text-align: center; 
  z-index: 20; 
}

.banner-title {
  color: #fff;
  font-size: 1.8rem; /* Smaller font size to prevent wrapping/overlap */
  text-transform: uppercase;
  text-shadow: 4px 4px 0 #000;
  margin-bottom: 20px;
  line-height: 1.2;
  font-family: 'Press Start 2P', cursive;
  position: relative;
  z-index: 10;
}

.banner-subtitle {
  color: #ffd700;
  font-size: 0.7rem; /* Smaller font */
  margin-bottom: 30px; /* Reduced margin */
  letter-spacing: 1px;
  font-family: 'Press Start 2P', cursive;
  background: #000;
  padding: 8px 12px;
  border: 2px solid #5a3e75;
  box-shadow: 4px 4px 0 #000;
}

.banner-attributes {
  display: flex;
  gap: 10px;
  margin-bottom: auto;
  position: absolute;
  top: 15px;
  right: 60px; /* Moved left to avoid close button overlap */
}
.up-rate-badge.pixel-badge {
  background: #f44336;
  border: 4px solid #b71c1c;
  color: #fff;
  padding: 6px 10px;
  font-size: 0.6rem;
  box-shadow: 4px 4px 0 #000;
  font-family: 'Press Start 2P', cursive;
}

/* WISH BUTTONS */
.wish-controls {
  display: flex;
  gap: 15px; /* Reduced gap */
  margin-top: 20px; /* Reduced margin */
  width: 100%;
  justify-content: center; /* Center buttons */
}

.pixel-btn {
  flex: 1;
  background: #5c6bc0;
  color: #fff;
  border: 4px solid #283593;
  padding: 15px 5px; /* Reduced padding */
  font-family: 'Press Start 2P';
  font-size: 0.7rem; /* Smaller font */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 6px 6px 0 #1a237e;
  position: relative;
  transition: transform 0.1s;
}

.pixel-btn:active {
  transform: translate(2px, 2px); /* Physical press feeling */
  box-shadow: 2px 2px 0 #1a237e;
  filter: brightness(0.9); /* Visual darkening on press */
}

.pixel-btn.gold {
  background: #ffb300;
  border-color: #ff6f00;
  box-shadow: 6px 6px 0 #e65100;
  color: #4e342e;
}
.pixel-btn.gold:active {
   transform: translate(2px, 2px);
   box-shadow: 2px 2px 0 #e65100;
   filter: brightness(0.9);
}

.wish-btn-label {
  font-size: 0.8rem;
  margin-bottom: 10px;
  text-shadow: 2px 2px 0 #000;
}
.pixel-btn.gold .wish-btn-label {
  color: #4e342e;
  text-shadow: none;
  font-weight: 900;
}

.wish-cost {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 0.75rem;
  background: rgba(0,0,0,0.3);
  padding: 6px 12px;
  border-radius: 4px;
}
.pixel-gem-icon-sm {
  width: 16px;
  height: 16px;
  background: #00ffff;
  box-shadow: 0 0 5px #00ffff;
  clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
}

.banner-nav-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: 50px;
  height: 80px;
  background: #4a3b5a;
  border: 4px solid #000;
  color: #fff;
  cursor: pointer;
  z-index: 50;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 6px 6px 0 #000;
  transition: all 0.1s;
}
.banner-nav-btn:active {
    transform: translate(0, -50%) scale(0.95); /* Slight shrink */
    box-shadow: 2px 2px 0 #000;
    filter: brightness(0.8);
}
.banner-nav-btn.left { left: -25px; }
.banner-nav-btn.right { right: -25px; }

.close-btn-corner.pixel-btn-close {
    top: -20px;
    right: -20px;
    width: 50px;
    height: 50px;
    background: #f44336;
    border: 4px solid #b71c1c;
    border-radius: 0;
    box-shadow: 6px 6px 0 #000;
    z-index: 100;
    transition: all 0.1s;
}
.close-btn-corner.pixel-btn-close:hover {
    background: #ff5252;
    transform: scale(1.05); /* Just a slight nudge for pixel perfection */
    color: #fff;
}
.close-btn-corner.pixel-btn-close:active {
    transform: scale(0.95);
    box-shadow: 2px 2px 0 #000;
    filter: brightness(0.8);
}


/* 3. CINEMA ANIMATION OVERLAY */
.summon-animation-layer {
  position: absolute;
  inset: 0;
  background: #000;
  z-index: 900;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* The Meteor */
.meteor-star {
  width: 20px;
  height: 20px;
  background: #fff;
  border-radius: 50%;
  position: absolute;
  box-shadow: 
    0 0 20px 10px rgba(255,255,255,0.8),
    0 0 50px 20px var(--meteor-color, #4488ff); /* Dynamic color variable */
  z-index: 905;
}
.meteor-trail {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 400px;
  height: 4px;
  background: linear-gradient(90deg, transparent, #fff);
  transform-origin: right center;
  transform: translate(-100%, -50%);
  filter: blur(2px);
}

/* 4. RESULT PRESENTATION (Full Screen) */
.gacha-result-scene {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle, #2a2a2a 0%, #000 90%);
  z-index: 800;
  display: flex;
  align-items: center;
  justify-content: center;
  perspective: 1000px;
}


.result-card-container {
  width: 320px;
  height: 520px;
  position: relative;
  background: #222;
  padding: 8px;
  border: 4px solid #fff;
  box-shadow: 
    12px 12px 0 #000,
    inset 4px 4px 0 rgba(255, 255, 255, 0.1);
  animation: none; /* Static or stepped float */
  image-rendering: pixelated; /* Enforce pixel look */
}

.result-art-full {
  width: 100%;
  height: 100%;
  object-fit: cover;
  background: #111;
  border-radius: 0;
  border: 4px solid #000;
  image-rendering: pixelated;
}

/* Rarity Frames (Hard Borders) */
.frame-3 {
  border-color: #4488ff !important;
  box-shadow: 
    0 0 0 4px #000,
    inset 0 0 0 4px #000,
    8px 8px 0 #000 !important;
}
.frame-4 {
  border-color: #a855f7 !important;
  box-shadow: 
    0 0 0 4px #000,
    inset 0 0 0 4px #000,
    8px 8px 0 #000 !important;
}
.frame-5 {
  border-color: #ffd700 !important;
  box-shadow: 
    0 0 0 4px #000,
    inset 0 0 0 4px #000, 
    12px 12px 0 #ffd700, /* Double shadow */
    20px 20px 0 #000 !important;
}

.result-meta {
  position: absolute;
  bottom: 16px;
  left: 16px;
  right: 16px;
  padding: 15px;
  background: #000;
  border: 4px solid #fff;
  box-shadow: 6px 6px 0 #000;
  text-align: center;
  color: #fff;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.8rem;
}

.close-btn-corner {
    position: absolute;
    top: 30px;
    right: 40px;
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.3);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 0.8rem; /* Lucide icon sizing usually handles itself, but this centers text */
}
.close-btn-corner:hover {
    background: #fff;
    color: #000;
    transform: rotate(90deg);
}

/* LEGENDARY REVEAL SCENE */
.legendary-reveal-overlay {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle, #5e4400 0%, #000 100%);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  overflow: hidden;
  cursor: pointer;
}

.legendary-rays {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 200vmax;
    height: 200vmax;
    background: conic-gradient(
        from 0deg, 
        transparent 0deg, 
        rgba(255, 215, 0, 0.2) 15deg, 
        transparent 30deg,
        rgba(255, 215, 0, 0.2) 45deg,
        transparent 60deg,
        rgba(255, 215, 0, 0.2) 75deg,
        transparent 90deg,
        rgba(255, 215, 0, 0.2) 105deg,
        transparent 120deg,
        rgba(255, 215, 0, 0.2) 135deg,
        transparent 150deg,
        rgba(255, 215, 0, 0.2) 165deg,
        transparent 180deg,
        rgba(255, 215, 0, 0.2) 195deg,
        transparent 210deg,
        rgba(255, 215, 0, 0.2) 225deg,
        transparent 240deg,
        rgba(255, 215, 0, 0.2) 255deg,
        transparent 270deg,
        rgba(255, 215, 0, 0.2) 285deg,
        transparent 300deg,
        rgba(255, 215, 0, 0.2) 315deg,
        transparent 330deg,
        rgba(255, 215, 0, 0.2) 345deg,
        transparent 360deg
    );
    animation: rotateRays 20s linear infinite;
    pointer-events: none;
    mask-image: radial-gradient(circle, transparent 10%, black 100%);
}

@keyframes rotateRays {
    from { transform: translate(-50%, -50%) rotate(0deg); }
    to { transform: translate(-50%, -50%) rotate(360deg); }
}

.legendary-burst {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 600px;
    height: 600px;
    background: radial-gradient(circle, rgba(255, 215, 0, 0.5) 0%, transparent 70%);
    animation: pulseBurst 3s ease-in-out infinite;
    pointer-events: none;
    z-index: 1;
}

@keyframes pulseBurst {
    0%, 100% { opacity: 0.6; transform: translate(-50%, -50%) scale(1); }
    50% { opacity: 0.3; transform: translate(-50%, -50%) scale(1.3); }
}

.legendary-char-container {
    position: relative;
    z-index: 10;
    display: flex;
    flex-direction: column;
    align-items: center;
    animation: scaleIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.legendary-char-img {
    height: 60vh;
    filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.9));
    transform-origin: bottom center;
}

.legendary-title {
    font-family: 'Press Start 2P';
    color: #ffd700;
    font-size: 2.5rem;
    text-shadow: 4px 4px 0 #8b6508, 0 0 20px #ff8c00;
    margin-top: 30px;
    animation: slideUpFade 0.6s ease-out 0.2s backwards;
    text-align: center;
}

.legendary-stars {
    display: flex;
    gap: 10px;
    margin-top: 10px;
    animation: slideUpFade 0.6s ease-out 0.4s backwards;
}

.legendary-desc {
    color: #fff;
    font-size: 1rem;
    margin-top: 15px;
    opacity: 0.8;
    animation: slideUpFade 0.6s ease-out 0.6s backwards;
}

@keyframes slideUpFade {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Portrait Warning Overlay */
.portrait-warning {
  display: none;
  position: fixed;
  inset: 0;
  background: #0a0a0a;
  z-index: 10000;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 20px;
  color: #ffd700;
  font-family: 'Press Start 2P', cursive;
}

.rotate-icon {
  width: 60px;
  height: 100px;
  margin-bottom: 30px;
  border: 4px solid #ffd700;
  border-radius: 8px;
  position: relative;
  animation: rotateDevice 2s ease-in-out infinite;
}

.rotate-icon::after {
  content: '';
  position: absolute;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  width: 10px;
  height: 10px;
  border: 2px solid #ffd700;
  border-radius: 50%;
}

@keyframes rotateDevice {
  0%, 10% { transform: rotate(0deg); }
  45%, 55% { transform: rotate(-90deg); }
  90%, 100% { transform: rotate(-90deg); }
}

/* PWA Install Button Styles */
.pixel-install-btn {
  background: #4caf50;
  border: 4px solid #2e7d32;
  color: #fff;
  padding: 10px 15px;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.7rem;
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  box-shadow: 4px 4px 0 #000;
  transition: all 0.2s;
}

.pixel-install-btn:hover {
  transform: translateY(-2px);
  filter: brightness(1.1);
  box-shadow: 6px 6px 0 #000;
}

.pixel-install-btn:active {
  transform: translateY(2px);
  box-shadow: 2px 2px 0 #000;
}

.install-row {
  margin-top: 20px;
  padding-top: 20px;
  border-top: 2px dashed rgba(255, 255, 255, 0.1);
}

.warning-text-large {
  font-size: 1.2rem;
  margin-bottom: 15px;
  line-height: 1.5;
}

.warning-text-small {
  font-size: 0.6rem;
  color: rgba(255, 255, 255, 0.6);
  line-height: 1.8;
  margin-bottom: 20px;
}

.force-landscape-btn {
  background: var(--pixel-gold);
  border: 4px solid var(--pixel-gold-dark);
  color: #000;
  padding: 10px 20px;
  font-family: 'Press Start 2P', cursive;
  font-size: 0.7rem;
  cursor: pointer;
  box-shadow: 4px 4px 0 #000;
  transition: all 0.2s;
}

.force-landscape-btn:hover {
  transform: translateY(-2px);
  filter: brightness(1.1);
  box-shadow: 6px 6px 0 #000;
}

.force-landscape-btn:active {
  transform: translateY(2px);
  box-shadow: 2px 2px 0 #000;
}

@media (orientation: portrait) and (max-width: 1024px) {
  .portrait-warning {
    display: flex;
  }
}
