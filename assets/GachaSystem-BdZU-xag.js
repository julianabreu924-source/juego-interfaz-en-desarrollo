import{c as B,w as O,h as G,a as D,r as F,s as f,u as P,b as m,j as e,A as V,m as r,X as $,C as q,d as U}from"./index-YyhdMH-z.js";import{g as A}from"./index-CjhSK9dJ.js";const Y=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],u=B("star",Y),n={SOLAS:{id:"solas",name:"Archimago Solas",rarity:5,image:O,desc:"Maestro de las Artes Arcanas, portador de magia cósmica antigua.",color:"#8a2be2",stats:{atk:120,def:40,hp:800}},ELFA:{id:"elfa",name:"Guardabosques Élfica",rarity:5,image:G,desc:"Una depredadora silenciosa de los bosques, nunca falla un tiro.",color:"#4caf50",stats:{atk:100,def:50,hp:900}},MAGO_BATALLA:{id:"mago_batalla",name:"Mago de Batalla",rarity:5,image:D,desc:"Combinando acero y hechicería para dominar el campo de batalla.",color:"#f44336",stats:{atk:110,def:80,hp:1200}},REINA:{id:"reina",name:"Reina",rarity:5,image:F,desc:"Sábia de la luz, especialista en restauración y protección divina.",color:"#ffd700",stats:{atk:60,def:70,hp:1500}}},h=[{id:"banner_wizard",title:`ASCENSIÓN
ARCANA`,subTitle:"Deseo de Evento - Archimago Solas",character:n.SOLAS,color:n.SOLAS.color},{id:"banner_hunter",title:`CAZA
SILENCIOSA`,subTitle:"Deseo de Evento - Guardabosques Élfica",character:n.ELFA,color:n.ELFA.color},{id:"banner_warrior",title:`FORJADO EN
BATALLA`,subTitle:"Deseo de Evento - Mago de Batalla",character:n.MAGO_BATALLA,color:n.MAGO_BATALLA.color},{id:"banner_reina",title:`LUZ
DIVINA`,subTitle:"Deseo de Evento - Reina",character:n.REINA,color:n.REINA.color}],p=[{id:"com_1",name:"Daga Oxidada",rarity:3,image:f,desc:"Mejor que nada"},{id:"com_2",name:"Pergamino Viejo",rarity:3,image:f,desc:"Contiene hechizos básicos"},{id:"rare_1",name:"Báculo del Vacío",rarity:4,image:f,desc:"Corrompido por magia oscura"}],H=({onBack:I})=>{const{spendGems:w,addCharacter:C,gems:S}=P(),[o,x]=m.useState("idle"),[t,j]=m.useState([]),[b,g]=m.useState([]),[L,N]=m.useState(0),l=h[L],R=()=>N(a=>(a+1)%h.length),E=()=>N(a=>(a-1+h.length)%h.length),M=()=>{const a=Math.random()*100;let s;if(a<5)s=l.character;else if(a<25)s=p.find(i=>i.rarity===4)||p[0];else{const i=p.filter(d=>d.rarity===3);s=i[Math.floor(Math.random()*i.length)]}return s.rarity===5&&C(s),{...s,instanceId:`${s.id}_${Date.now()}_${Math.random()}`}},v=a=>{const s=a===1?160:1600;if(S<s){alert("¡No tienes suficientes gemas!");return}w(s);const i=[];for(let c=0;c<a;c++)i.push(M());i.sort((c,k)=>k.rarity-c.rarity);const d=i.filter(c=>c.rarity===5);g(d),j(i),x("wishing")};m.useEffect(()=>{if(o==="wishing"){const a=setTimeout(()=>{x("result")},2500);return()=>clearTimeout(a)}},[o]);const T=()=>{x("idle"),j([]),g([])},_=()=>{g(a=>a.slice(1))},z=()=>{if(t.length===0)return"#fff";const a=Math.max(...t.map(s=>s.rarity));return a===5?"#ffd700":a===4?"#a855f7":"#4488ff"},y=b[0];return e.jsxs("div",{className:"gacha-overlay",children:[o==="idle"&&e.jsx("div",{className:"stars-bg-layer"}),e.jsx(V,{mode:"wait",children:o==="idle"&&e.jsxs(r.div,{className:"wish-banner pixel-panel",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsx("button",{className:"close-btn-corner pixel-btn-close",onClick:I,style:{zIndex:100},children:e.jsx($,{size:24})}),e.jsx("button",{onClick:E,className:"banner-nav-btn left",children:e.jsx(q,{size:32})}),e.jsx("button",{onClick:R,className:"banner-nav-btn right",children:e.jsx(U,{size:32})}),e.jsx("div",{className:"banner-art-section",children:e.jsx("div",{className:"banner-art-frame",children:e.jsx(r.img,{src:l.character.image,className:"banner-char-img",animate:{x:[0,-10,0]},transition:{duration:6,repeat:1/0,ease:"easeInOut"}},l.character.image)})}),e.jsxs("div",{className:"banner-info-section",children:[e.jsx("div",{className:"banner-attributes",children:e.jsx("span",{className:"up-rate-badge pixel-badge",children:"UP RATE"})}),e.jsx("h1",{className:"banner-title pixel-text-title",children:l.title}),e.jsx("div",{className:"banner-subtitle pixel-text-subtitle",style:{color:l.color},children:l.subTitle}),e.jsxs("div",{className:"wish-controls",children:[e.jsxs("button",{className:"wish-btn pixel-btn",onClick:()=>v(1),children:[e.jsx("span",{className:"wish-btn-label",children:"INVOCAR x1"}),e.jsxs("span",{className:"wish-cost",children:[e.jsx("img",{src:A,className:"pixel-gem-icon-sm",alt:"Gem"}),"160"]})]}),e.jsxs("button",{className:"wish-btn pixel-btn gold",onClick:()=>v(10),children:[e.jsx("span",{className:"wish-btn-label",children:"INVOCAR x10"}),e.jsxs("span",{className:"wish-cost",children:[e.jsx("img",{src:A,className:"pixel-gem-icon-sm",alt:"Gem"}),"1600"]})]})]})]})]},l.id)}),o==="wishing"&&t.length>0&&e.jsxs("div",{className:"summon-animation-layer",children:[e.jsx(r.div,{style:{position:"absolute",inset:0,background:"#fff",zIndex:999},initial:{opacity:1},animate:{opacity:0},transition:{duration:.5}}),e.jsx(r.div,{className:"meteor-star",style:{"--meteor-color":z()},initial:{x:"120vw",y:"-20vh",scale:.5,rotate:15},animate:{x:"-20vw",y:"120vh",scale:[1,2,0],rotate:45},transition:{duration:2,ease:"easeInOut"},children:e.jsx("div",{className:"meteor-trail"})}),t.length>1&&[...Array(15)].map((a,s)=>e.jsx(r.div,{className:"meteor-star",style:{"--meteor-color":s%2===0?"#4488ff":"#fff",width:Math.random()*10+5,height:Math.random()*10+5,borderRadius:0},initial:{x:"120vw",y:"-20vh",opacity:0},animate:{x:"-25vw",y:"125vh",opacity:[0,1,0],rotate:Math.random()*360},transition:{duration:2+Math.random()*.5,delay:Math.random()*.5,ease:"easeInOut"}},s)),e.jsx(r.div,{style:{position:"absolute",inset:0,background:"#fff"},initial:{opacity:0},animate:{opacity:[0,1]},transition:{delay:1.8,duration:.2}})]}),o==="result"&&t.length>0&&e.jsx(e.Fragment,{children:b.length>0?e.jsxs("div",{className:"legendary-reveal-overlay",onClick:_,children:[e.jsx("div",{className:"legendary-rays"}),e.jsx("div",{className:"legendary-burst"}),e.jsxs("div",{className:"legendary-char-container",children:[e.jsx("img",{src:y.image,className:"legendary-char-img"}),e.jsx("div",{className:"legendary-title",children:y.name}),e.jsx("div",{className:"legendary-stars",children:[...Array(5)].map((a,s)=>e.jsx(u,{size:40,fill:"#ffd700",color:"#ffd700"},s))})]})]},y.instanceId):e.jsxs("div",{className:"gacha-result-scene",onClick:T,style:{overflowY:"auto",alignItems:t.length>1?"flex-start":"center",paddingTop:t.length>1?40:0},children:[e.jsx("div",{className:"stars-bg-layer",style:{position:"fixed"}}),t.length===1?e.jsxs(r.div,{className:"result-card-container",initial:{scale:0,opacity:0,rotateY:90},animate:{scale:1,opacity:1,rotateY:0},transition:{type:"spring",damping:12,delay:.2},children:[e.jsx("img",{src:t[0].image,className:`result-art-full frame-${t[0].rarity}`}),e.jsxs("div",{className:"result-meta",children:[e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:10,gap:5},children:[...Array(t[0].rarity)].map((a,s)=>e.jsx(u,{size:20,fill:"#ffd700",color:"#ffd700"},s))}),e.jsx("h2",{style:{fontSize:"1.2rem",marginBottom:5},children:t[0].name}),e.jsx("p",{style:{fontSize:"0.7rem",color:"#ccc"},children:t[0].desc}),e.jsx("p",{style:{fontSize:"0.6rem",marginTop:15,opacity:.5},children:"Click anywhere to close"})]})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"20px",maxWidth:"1000px",margin:"auto",zIndex:850,paddingBottom:40},children:t.map((a,s)=>e.jsxs(r.div,{className:`result-card-mini frame-${a.rarity}`,style:{width:"100%",aspectRatio:"3/5",background:"#1a1a1a",position:"relative",display:"flex",flexDirection:"column",alignItems:"center",padding:10,borderRadius:4},initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{delay:s*.1},children:[e.jsx("img",{src:a.image,style:{width:"80%",flex:1,objectFit:"contain"}}),e.jsx("div",{style:{fontSize:"0.6rem",color:"#fff",textAlign:"center",marginTop:5},children:a.name}),e.jsx("div",{style:{display:"flex",marginTop:5},children:[...Array(a.rarity)].map((i,d)=>e.jsx(u,{size:8,fill:"#ffd700",color:"#ffd700"},d))})]},s))})]})})]})};export{H as default};
